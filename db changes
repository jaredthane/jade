alter table receipts add column date datetime;
alter table entities add column client_accounts_group_id int(11);
alter table entities add column vendor_accounts_group_id int(11);
create table entries (id int(11) not null primary key auto_increment, post_id int(11), account_id int(11), balance decimal(8,2), created_at datetime);
alter table movements add column line_id int(11);
alter table orders add column purchase_receipt_number int(11);
alter table trans add column tipo varchar(255);
alter table trans add column is_payment tinyint(1);
update post_types set id = -1 where id=2;
alter table accounts add column balance decimal(8,2) default 0;
insert into entities (id, entity_type_id, name) values (9, 2, 'Anulado');
-- Base done to here --
alter table orders add column next_order int(11);
alter table orders add column receipt_filename varchar(255);
update orders inner join receipts on receipts.order_id=orders.id set orders.receipt_number=receipts.number;
update orders inner join receipts on receipts.order_id=orders.id set orders.receipt_filename=receipts.filename;
alter table orders add column receipt_generated datetime;
alter table payments drop column receipt_id;
alter table orders change column receipt_number receipt_number char(8);
alter table entities change column next_receipt_number next_receipt_number char(8);
ALTER TABLE orders ADD INDEX(receipt_number);
ALTER TABLE orders ADD INDEX(created_at);
ALTER TABLE orders ADD INDEX(client_id);
ALTER TABLE orders ADD INDEX(vendor_id);
ALTER TABLE entries ADD INDEX(created_at);
ALTER TABLE payments ADD INDEX(order_id);
ALTER TABLE receipts ADD INDEX(order_id);
ALTER TABLE payments ADD INDEX(created_at);
ALTER TABLE movements ADD INDEX(order_id);
alter table payments change column canceled void datetime;
alter table trans add column payment_id int(11);
update trans set payment_id = order_id where is_payment;
update trans set order_id=null where is_payment ;
alter table trans drop column is_payment ;
alter table payments drop column receipt_id;
update accounts set modifier=-1 where id=10;
insert into rights (id, name) values (83, 'Crear Transacciones'),(84,'Cambiar Transacciones'),(85,'Ver Transacciones'),(86,'Borrar Transacciones');
