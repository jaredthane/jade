<% if @entity.id==1 %>
	<% content_for :title do %>Detalles de <%= @entity.name %><% end %>
<% else %>
	<% content_for :title do %>Detalles del <%= @entity.entity_type.name %> "<%= @entity.name %>" #<%= @entity.id %><% end %>
<% end %>

<% content_for :actions do %>
	<% if @entity.entity_type.id == 3 %>
	    <dt><%= link_to 'Nuevo', new_site_path, :class => 'action' %></dt>
	    <dt><%= link_to 'Cambiar', edit_entity_path(@entity), :class => 'action' %></dt>
		<dt><%= link_to 'Compras Aqui', purchases_path, :class => 'action' %>  </dt>
		<dt><%= link_to 'Ventas Aqui', sales_path, :class => 'action' %>  </dt>
	    <dt><%= link_to 'Lista', sites_path, :class => 'action' %></dt>
	<% end %>
	<% if @entity.entity_type.id == 2 or @entity.entity_type.id == 5 %>
	    <dt><%= link_to 'Nuevo', new_client_path, :class => 'action' %></dt>
	    <dt><%= link_to 'Cambiar', edit_entity_path(@entity), :class => 'action' %></dt>
	    <dt><%= link_to 'Lista', clients_path, :class => 'action' %></dt>
	<% end %>
	<% if @entity.entity_type.id == 1 %>
	    <dt><%= link_to 'Nuevo', new_vendor_path, :class => 'action' %></dt>
	    <dt><%= link_to 'Cambiar', edit_entity_path(@entity), :class => 'action' %></dt>
	    <dt><%= link_to 'Lista', vendors_path, :class => 'action' %></dt>
	<% end %>
<% end %>

  <% if @entity.entity_type_id !=3 and @entity.birthday? %>  
  	<% flash[:important] = 'Este cliente esta cumpliendo anos..' %> 
  <% end %>
<div class="column2-unit-left">
	<p>
		<b>Nombre</b><br />		
		<%=h @entity.name %>
	</p>
	<% if @entity.entity_type.id == 3 %>
	  <% if current_user.has_rights(['admin','contabilidad','gerente']) %>
	    <p>
			  <b>Cuenta de Efectivo</b><br />
			  <% if @entity.cash_account %>
  			  <%=link_to @entity.cash_account.name, @entity.cash_account %>
			  <% end %>
		  </p>
	    <p>
			  <b>Cuenta de Inventario</b><br />
			  <% if @entity.inventory_account %>
  			  <%=link_to @entity.inventory_account.name, @entity.inventory_account %>
			  <% end %>
		  </p>
	    
		<% end %>
	<% end %>
	<% if @entity.entity_type.id == 2 or @entity.entity_type.id == 5 %>
		<p>
			<b>Nacimiento</b><br />		
			<% if @entity.birth %>
				<%=h @entity.birth.strftime('%B %d') %>
			<% end %>
			
		</p>
	<% end %>
	<% if @entity.entity_type.id == 2 or @entity.entity_type.id == 5 or @entity.entity_type.id == 1 %>
		<p>
			<b>Direcion</b><br />
			<%=h @entity.address %>
		</p>
		<p>
			<b>Departamento</b><br />		
			<%=h @entity.state.name %>
		</p>
		<p>
			<b>Municipio</b><br />		
			<%=h @entity.city %>
		</p>
		<p>
			<b>Grupo de Precios</b><br />		
			<% if @entity.price_group_name %>
				<%=h @entity.price_group_name.name %>
			<% end %>
			
		</p>
	<% end %>
	<% if @entity.entity_type.id == 3 %>
		<p>
			<b>Grupo de Precios por Defecto</b><br />		
				<% if @entity.price_group %>
					<%=h @entity.price_group.price_group_name.name %>
				<% end %>
			
		</p>
	<% end %>
	<% if @entity.entity_type.id == 2 or @entity.entity_type.id == 5 %>
		<p>
			<b>Asesor de Cliente</b><br />		
				<% if @entity.user %>
					<%=link_to @entity.user.login, @entity.user %>
				<% end %>
		</p>
	<% end %>
</div>
<div class="column2-unit-right">
	<p>
		<b>Tipo</b><br />
		<% if @entity.entity_type %>
			<%=h @entity.entity_type.name %>
		<% end %>
	</p>
  <% if @entity.entity_type.id == 3 %>
	  <% if current_user.has_rights(['admin','contabilidad','gerente']) %>
      <p>
			  <b>Cuenta de Ingresos</b><br />
			  <% if @entity.revenue_account %>
  			  <%=link_to @entity.revenue_account.name, @entity.revenue_account %>
			  <% end %>
		  </p>
	    <p>
			  <b>Cuenta de Gastos</b><br />
			  <% if @entity.expense_account %>
  			  <%=link_to @entity.expense_account.name, @entity.expense_account %>
			  <% end %>
		  </p>
	    <p>
			  <b>Cuenta de Impuestos</b><br />
			  <% if @entity.tax_account %>
  			  <%=link_to @entity.tax_account.name, @entity.tax_account %>
			  <% end %>
		  </p>
		<% end %>
  <% end %>
	<% if @entity.entity_type.id == 2 or @entity.entity_type.id == 5 or @entity.entity_type.id == 1 %>
	  <% if current_user.has_rights(['admin','contabilidad','gerente']) %>
	    <p>
		    <b>Cuenta para Cobrar</b><br />
		    <% if @entity.cash_account %>
  		    <%=link_to @entity.cash_account.name, @entity.cash_account%>
		    <% end %>
		  </p>
	    <p>
		    <b>Cuenta para Recibir Pagos</b><br />
		    <% if @entity.revenue_account %>
  		    <%=link_to @entity.revenue_account.name, @entity.revenue_account%>
		    <% end %>
		  </p>
	   <% end %>
	<p>
		<b>Telefono Fijo</b><br />
		<%=h @entity.home_phone_number %>
		
	</p>
	<p>
		<b>Telefono Oficina</b><br />
		<%=h @entity.office_phone_number %>
	</p>
	<p>
		<b>Telefono Celular</b><br />
		<%=h @entity.cell_phone_number %>
	</p>
	<p>
		<b>Correo E</b>
		<%=h @entity.email %>
	</p>
	<% end %>
	<% if @entity.entity_type.id == 2 or @entity.entity_type.id == 5 %>
		<p>
			<b>Registro</b>
			<%=h @entity.register %>
		</p>
		<p>
			<b>NIT</b><br />
			<%=h @entity.nit_number %>
		</p>
		<p>
			<b>Giro</b><br />
			<%=h @entity.giro %>
		</p>
	<% end %>
</div>
<hr class="clear-contentunit" />
<% case @entity.entity_type_id 
	when 1,2,5 %>
		<p>
			<b>Compras:</b>
			<div>
				<div class="table_header_row">
					<div class="table_cell_10">Numero</div>
					<div class="table_cell_20">Proveedor</div>
					<div class="table_cell_20">Cliente</div>
					<div class="table_cell_15">Received</div>
					<div class="table_cell_15">Ordered</div>
					<div class="table_cell_right_20">User</div>
				</div>
				<% if @entity.entity_type_id == 1 %>
					<% for order in Order.find_all_by_vendor_id(@entity, :limit => 20) %>
						<div class="table_row">
							<div class="table_cell_10"><%= link_to order.id, order %></div>
							<div class="table_cell_20"><%= link_to order.vendor.name, order.vendor %></div>
							<div class="table_cell_20"><%= link_to order.client.name, order.client %></div>
							<div class="table_cell_15"><%=h order.received %></div>
							<div class="table_cell_15"><%=h order.created_at.to_date.to_s %></div>
							<div class="table_cell_right_20"><%= link_to order.user.login, order.user %></div>
						</div>
					<% end %>
				<% else %>
					<% for order in Order.find_all_by_client_id(@entity, :limit => 20) %>
						<div class="table_row">
							<div class="table_cell_10"><%= link_to order.id, order %></div>
							<div class="table_cell_20"><%= link_to order.vendor.name, order.vendor %></div>
							<div class="table_cell_20"><%= link_to order.client.name, order.client %></div>
							<div class="table_cell_15"><%=h order.received %></div>
							<div class="table_cell_15"><%=h order.created_at.to_date.to_s %></div>
							<div class="table_cell_right_20"><%= link_to order.user.login, order.user %></div>
						</div>
					<% end %>
				<% end %>
			</div>
		</p>
	<% when 3 %>
		<p>
			<b>Movimientos:</b>
			<div>
				<div class="table_header_row">
					<div class="table_cell_15">Movimiento</div>
					<div class="table_cell_15">Pedido</div>
					<div class="table_cell_20">Producto</div>
					<div class="table_cell_15">Cantidad (Num. Serie)</div>
					<div class="table_cell_15">Usuario</div>
					<div class="table_cell">Fecha</div>
				</div>
				<% for movement in Movement.find_all_by_entity_id(@entity, :order => 'created_at DESC', :limit => 20) %>
					<div class="table_row">
						<div class="table_cell_15"><%=link_to movement.movement_type.name, :controller => "movements", :search => movement.product.upc %></div>
						<div class="table_cell_15"><%=link_to movement.order.id, movement.order %></div>
						<div class="table_cell_20"><%=link_to movement.product.name, movement.product %></div>
						<% if movement.product.serialized %>
							<div class="table_cell_15"><%=link_to "(" + movement.serialized_product.serial_number.to_s + ')', movement.serialized_product %> </div>
						<% else %>
							<div class="table_cell_15"><%=h movement.quantity %> </div>
						<% end %>
						<div class="table_cell_15"><%=link_to movement.user.login, movement.user %> </div>
						<div class="table_cell"><%=h movement.created_at.to_date.to_s %> </div>
					</div>
				<% end %>
			</div>
		</p>

<% end %>

