<div class="line">
	<% @line= line %>
	<%= error_messages_for :line, :class => "lineErrorExplanation",:id => "lineErrorExplanation", :object_name => "", :header_message => "", :message => "" %>
	<% prefix = line.new_record? ? 'new_lines' : 'existing_lines' %>
  <% fields_for "#{prefix}[]", line do |line_form| %>
		<div class="table_row">
			<div class="table_cell_15">
				<%= link_to line.product.upc, line.product %>
			</div>
			<div class="table_cell_15">
				<%= link_to line.product.name, line.product %>
				<%= line_form.hidden_field :product_id, :value => line.product.id %>
			</div>
			<%= line_form.hidden_field :order_type_id, :value => 5 %>
			<div id="test3" class="table_cell_10">
				<input disabled=True class="field" id="cost" value= <%= line.product.cost %> >
			</div>
			<% if line.product.serialized %>
				<div class="table_cell_10"><%= h line.quantity %></div>	
				<%= line_form.hidden_field :quantity, :value => 1 %>
			<% else %>		
				<div  id="test2" class="table_cell_10">
					<input disabled=True class="field" id="qty" value= <%= line.product.quantity %> >
				</div>	
				<div id="test1" class="table_cell_10">
					<%= line_form.text_field :quantity, :id => 'serial', :class => 'serial', :onblur=>'calc_dif(this)' %>
				</div>	
			<% end %>
			
			<div id="test4" class="table_cell_10"><%= line_form.text_field :price, :value => (line.quantity - line.product.quantity)* line.product.cost, :disabled =>'True', :class => 'field'  %></div>	
			<% if line.product.serialized %>
				<div class="table_cell_20"><%= line_form.text_field :serial_number, :id => 'serial', :class => 'serial' %></div>
			<% else %>
				<div class="table_cell_20"></div>
			<% end %>
			<%= line_form.hidden_field :id %>
			<div class="table_cell">
				<%= line_form.hidden_field :isreceived_str, :class => 'applied'%>
				<%= link_to_function "Aplicar", '$(this).previous().value="Si"; $(this).hide()' %>
				<%= link_to_function "Remover", "$(this).up().up().remove()" %>
			</div>

		</div>
	<% end %>
</div>

