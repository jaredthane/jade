<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml"><head profile="http://gmpg.org/xfn/11">



<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Swapfile for my brain  » Blog Archive   » Custom loggers in rails</title>

<meta name="generator" content="WordPress 2.2"> <!-- leave this for stats -->

<link rel="stylesheet" href="Swapfile%20for%20my%20brain%20%C2%BB%20Blog%20Archive%20%C2%BB%20Custom%20loggers%20in%20rails_files/style.css" type="text/css" media="screen">
<link rel="alternate" type="application/rss+xml" title="Swapfile for my brain RSS Feed" href="http://simplygenius.com/geekblog/feed/">
<link rel="pingback" href="http://simplygenius.com/geekblog/xmlrpc.php">

<style type="text/css" media="screen">

	#page { background: url("http://simplygenius.com/geekblog/wp-content/themes/default/images/kubrickbgwide.jpg") repeat-y top; border: none; }

</style>

	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://simplygenius.com/geekblog/xmlrpc.php?rsd">
<style type="text/css">.recentcomments a{display:inline !important;padding: 0 !important;margin: 0 !important;}</style>
</head><body>
<div id="page">


<div id="header">
	<div id="headerimg">
		<h1><a href="http://simplygenius.com/geekblog/">Swapfile for my brain</a></h1>
		<div class="description">Matt Conway’s blog - Keeping track of all my bits</div>
	</div>
</div>
<hr>

	<div id="content" class="widecolumn">

	
		<div class="navigation">
			<div class="alignleft">« <a href="http://simplygenius.com/geekblog/2007/06/11/life-at-a-startup-mobicious/">Life at a Startup (Mobicious)</a></div>
			<div class="alignright"><a href="http://simplygenius.com/geekblog/2007/06/15/web-crawling-with-ruby/">Web crawling with Ruby</a> »</div>
		</div>

		<div class="post" id="post-36">
			<h2><a href="http://simplygenius.com/geekblog/2007/06/15/custom-loggers-in-rails/" rel="bookmark" title="Permanent Link: Custom loggers in rails">Custom loggers in rails</a></h2>

			<div class="entry">
				<p>I
ran into some problems trying to setup a custom logger in rails which I
thought I would share to ease someone else’s pain. Everything I read
said that to setup a custom logger instance, I should set config.logger
in my environment.rb, e.g.<br>
<code><br>
environment.rb:</code></p>
<p>config.logger = MyLogger.new(config.log_path)<br>
<br>
However, I just could not get this to have any effect! It turns out
that this was because I was starting up my server using script/server
using mongrel. Using “script/server webrick”, or “mongrel_rails start”
worked just fine.</p>
<p>I think this is caused by code in the mongrel.rb file that
script/server uses which loads just the logging environment (but not my
environment) in order to figure out which log file to tail</p>
<p><code><br>
railties/lib/server/mongrel.rb:</code></p>
<p>require 'initializer'<br>
Rails::Initializer.run(:initialize_logger)<br>
<br>
Loading the environment here causes the RAILS_DEFAULT_LOGGER constant
to get set, and thus when my config finally gets loaded when mongrel
itself starts up, the config.logger I set gets ignored as the rails
init code does nothing if RAILS_DEFAULT_LOGGER is set:</p>
<p><code><br>
railties/lib/initializer.rb:</code></p>
<p>def initialize_logger<br>
  # if the environment has explicitly defined a logger, use it<br>
  return if defined?(RAILS_DEFAULT_LOGGER)<br>
  ...<br>
end<br>
</p>
<p>The patch on <a href="http://dev.rubyonrails.org/ticket/7084">this bug report</a> seems related, but didn’t fix my problem.</p>
<p>I’m too much a rails newb to figure out the <em>right</em> way to patch this, hopefully someone with more of a clue will see this blog entry and submit a patch <img src="Swapfile%20for%20my%20brain%20%C2%BB%20Blog%20Archive%20%C2%BB%20Custom%20loggers%20in%20rails_files/icon_smile.gif" alt=":)" class="wp-smiley"> </p>

				
				<p class="postmetadata alt">
					<small>
						This entry was posted
												on Friday, June 15th, 2007 at 6:22 pm						and is filed under <a href="http://simplygenius.com/geekblog/category/rails/" title="View all posts in Rails" rel="category tag">Rails</a>,  <a href="http://simplygenius.com/geekblog/category/coding/" title="View all posts in Coding" rel="category tag">Coding</a>.
						You can follow any responses to this entry through the <a href="http://simplygenius.com/geekblog/2007/06/15/custom-loggers-in-rails/feed/">RSS 2.0</a> feed.

													You can <a href="#respond">leave a response</a>, or <a href="http://simplygenius.com/geekblog/2007/06/15/custom-loggers-in-rails/trackback/" rel="trackback">trackback</a> from your own site.

						
					</small>
				</p>

			</div>
		</div>

	
<!-- You can start editing here. -->


			<!-- If comments are open, but there are no comments. -->

	 


<h3 id="respond">Leave a Reply</h3>


<form action="http://simplygenius.com/geekblog/wp-comments-post.php" method="post" id="commentform">


<p><input name="author" id="author" value="" size="22" tabindex="1" type="text">
<label for="author"><small>Name (required)</small></label></p>

<p><input name="email" id="email" value="" size="22" tabindex="2" type="text">
<label for="email"><small>Mail (will not be published) (required)</small></label></p>

<p><input name="url" id="url" value="" size="22" tabindex="3" type="text">
<label for="url"><small>Website</small></label></p>


<!--<p><small><strong>XHTML:</strong> You can use these tags: <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;code&gt; &lt;em&gt; &lt;i&gt; &lt;strike&gt; &lt;strong&gt; </code></small></p>-->

<p><textarea name="comment" id="comment" cols="100" rows="10" tabindex="4"></textarea></p>

<p><input name="submit" id="submit" tabindex="5" value="Submit Comment" type="submit">
<input name="comment_post_ID" value="36" type="hidden">
</p>

</form>



	
	</div>


<hr>
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link somewhere on your blog is the best way, it's our only promotion or advertising. -->
	<p>
		Swapfile for my brain is proudly powered by
		<a href="http://wordpress.org/">WordPress</a>
		<br><a href="http://simplygenius.com/geekblog/feed/">Entries (RSS)</a>
		and <a href="http://simplygenius.com/geekblog/comments/feed/">Comments (RSS)</a>.
		<!-- 17 queries. 0.190 seconds. -->
	</p>
</div>
</div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		<script src="Swapfile%20for%20my%20brain%20%C2%BB%20Blog%20Archive%20%C2%BB%20Custom%20loggers%20in%20rails_files/e-200851.js" type="text/javascript"></script>
<script type="text/javascript">
st_go({blog:'2686316',v:'ext',post:'36'});
var load_cmc = function(){linktracker_init(2686316,36,2);};
if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
else load_cmc();
</script><img id="wpstats" src="Swapfile%20for%20my%20brain%20%C2%BB%20Blog%20Archive%20%C2%BB%20Custom%20loggers%20in%20rails_files/g.gif" alt="">
<!-- Dynamic Page Served (once) in 0.188 seconds -->
</body></html>